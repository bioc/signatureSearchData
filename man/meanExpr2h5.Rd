% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/meanExpr2h5.R
\name{meanExpr2h5}
\alias{meanExpr2h5}
\title{Calculate mean expression value of compound treatment samples and save to HDF5 file}
\usage{
meanExpr2h5(gctx, inst, h5file, chunksize = 2000, overwrite = TRUE)
}
\arguments{
\item{gctx}{character(1), path to the LINCS level3 gctx file}

\item{inst}{tibble, LINCS level3 instances after filtering at specific concentration and time}

\item{h5file}{character(1), path to the destination hdf5 file}

\item{chunksize}{size of the matrix (number of columns) to be saved in HDF5 file by chunks}

\item{overwrite}{TRUE or FALSE, whether to overwrite or append the
matrix to the existing 'h5file'}
}
\value{
HDF5 file, representing the 'lincs_expr' database
}
\description{
Calculate mean expression values of replicated samples that are treated by the same
compound in the same cell type with selected concentration and treatment time after 
filtering the LINCS level3 instances/samples. 
Then write the mean expression matrix to an HDF5 file, which is the `lincs_expr`
database.
}
\examples{
gctx <- system.file("extdata", "test_sample_n2x12328.gctx", package="signatureSearchData")
h5file <- tempfile(fileext=".h5")
inst <- data.frame(inst_id=c("ASG001_MCF7_24H:BRD-A79768653-001-01-3:10",
                             "CPC012_SKB_24H:BRD-K81418486:10"), 
    pert_cell_factor=c('sirolimus__MCF7__trt_cp', 'vorinostat__SKB__trt_cp'))
meanExpr2h5(gctx, inst, h5file, overwrite=TRUE)
}
